# OVH Exporter

This is a Prometheus exporter for the OVH cloud API.

## API Auth

The OVH API uses a signed token, generated by their SDK, using an app key/secret and consumer secret.
The full process is described in https://docs.ovh.com/gb/en/api/first-steps-with-ovh-api/#advanced-usage-pair-ovhcloud-apis-with-an-application_2.

1. Sign up as a new app using the `/createToken` endpoint
2. Put the resulting secrets in an `.env` file or k8s secret
3. Mount or source those secrets before running

## Configuration

The following environment variables must be set:

- `OVH_ENDPOINT`
  - the name of the API endpoint to be used
  - like `ovh-ca`, `ovh-eu`, `ovh-us`
- `OVH_APP`
  - the application key, AK
- `OVH_SECRET`
  - the secret application key, AS
- `OVH_CONSUMER`
  - the secret consumer key, CK
- `OVH_PROJECT`
  - the ID of your public cloud project

## Metrics

The API has a number of GET endpoints that expose project usage and quota information. Some of these are
collected and exposed as Prometheus metrics.

- `swift_bucket_bytes_total`
  - `bucket`
- `swift_bucket_objects_total`
  - `bucket`

Metrics are fetched on an interval and cached, to reduce load on the API.
